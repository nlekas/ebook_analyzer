[tox]
envlist = lint,format,typecheck,test,build
isolated_build = true

[testenv]
deps =
    -e.[dev]
commands =
    python -m pytest --version

[testenv:lint]
description = Run ruff linter
commands =
    ruff check src/ tests/

[testenv:format]
description = Check code formatting with black
commands =
    black --check src/ tests/

[testenv:format-fix]
description = Format code with black
commands =
    black src/ tests/
skip_install = true

[testenv:ruff-fix]
description = Run ruff with auto-fix
commands =
    ruff check --fix src/ tests/
skip_install = true

[testenv:typecheck]
description = Run mypy type checker
commands =
    mypy src/

[testenv:test]
description = Run pytest tests
commands =
    pytest tests/ -v --cov=ebook_calibre_analyzer --cov-report=term-missing --cov-config=pyproject.toml

[testenv:build]
description = Build the package
commands =
    python -m build
skip_install = true

[testenv:all]
description = Run all checks (lint, format check, typecheck, test)
commands =
    {[testenv:lint]commands}
    {[testenv:format]commands}
    {[testenv:typecheck]commands}
    {[testenv:test]commands}

